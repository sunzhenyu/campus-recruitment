@using Campus.Recruitment.Enterprise.Models
@model List<Campus.Recruitment.Entities.Entity.Customers.CustomerAndBase>
@{
    //判断是否登录
    Layout = "~/Views/Shared/_Layout.cshtml";
    ViewBag.Title = "企业-首页";
}
<link href="@AppSetting.Rss_Image/content/static/css/corp/etp-gb.css" rel="stylesheet" type="text/css">
<link rel="stylesheet" href="@AppSetting.Rss_Image/content/static/lib/css/normalize.css">
<link rel="stylesheet" href="@AppSetting.Rss_Image/content/static/enterprise/css/homepage/index.css">
<link rel="stylesheet" href="@AppSetting.Rss_Image/content/static/enterprise/css/lib/homepage_search.css">
<link rel="stylesheet" href="@AppSetting.Rss_Image/content/static/enterprise/css/lib/majorPicker.css">
<link rel="stylesheet" href="@AppSetting.Rss_Image/content/static/zheyibu/static/css/dialog.css">
<link rel="stylesheet" href="@AppSetting.Rss_Image/content/static/css/corp/profile.css">
<script async="" src="@AppSetting.Rss_Image/content/static/zheyibu/components/google/gtm.js"></script>

<script src="@AppSetting.Rss_Image/content/static/js/sea-modules/seajs/seajs/2.1.1/sea.js" type="text/javascript"></script>
<script src="@AppSetting.Rss_Image/content/static/js/sea-modules/seajs/seajs-style/1.0.2/seajs-style.js" type="text/javascript"></script>
<script src="@AppSetting.Rss_Image/content/static/js/corp/init.js"></script>
<script type="text/javascript">
    seajs.config({
        alias: {
            $: 'jquery/jquery/1.7.2/jquery',
            placeholder: 'jquery/placeholder/1.0.0/placeholder',
            dialog: 'arale/dialog/1.2.3/dialog',
            validator: 'arale/validator/0.9.7/validator'
        }
    });
</script>
<script src="@AppSetting.Rss_Image/content/static/zheyibu/components/jQuery/jquery.min.js"></script>

<script src="@AppSetting.Rss_Image/content/static/zheyibu/components/jQuery/jquery.signalR-2.0.0.min.js"></script>
<script src="@AppSetting.Rss_Image/content/static/lib/js/base/jquery-1.11.3.min.js"></script>
<script src="@AppSetting.Rss_Image/content/static/zheyibu/components/layer/layer.js"></script>
<script src="@AppSetting.Rss_Image/content/static/html/demo/quickmark/jquery.qrcode.min.js"></script>

<!-- Banner start -->
<div id="logo-banner">
    <a href="javascript:;" target="_blank" class="part1bg part1-bg0 login" style="display: block;"></a>
    <a href="javascript:;" target="_blank" class="part1bg part1-bg1 active" style="display: block; "></a>
    <a href="javascript:;" target="_blank" class="part1bg part1-bg2" style="display: none;"></a>
    <a href="javascript:;" target="_blank" class="part1bg part1-bg3" style="display: none;"></a>
    <div class="part1-content">
        <div class="dot-list">
            <a href="javascript:;" class=""></a>
            <a href="javascript:;" class="active"></a>
            <a href="javascript:;" class=""></a>
            <a href="javascript:;" class=""></a>
        </div>
    </div>
</div>
<!-- Banner end -->
@*<div class="container cf">
    <div class="part8">
        <div class="part8-header">
            <p>高校专业信息查询<span>Beta</span></p>
            <p class="search-note">本工具可帮助企业了解或查询目标招聘生源所在的高校分布情况，为HR的校招工作提供参考</p>
        </div>
        <div class="part8-th">
            <div class="th-list divide">
                <span>专业类别</span><i></i>
            </div>
            <div class="th-list level">
                <span>高校级别</span><i></i>
            </div>
            <div class="th-list area">
                <span>高校所在地区</span><i></i>
            </div>
            <div class="btn-search">查询</div>
        </div>
        <input type="hidden" name="majorClass">
        <input type="hidden" name="schoolLevel">
        <input type="hidden" name="schoolArea">
    </div>
</div>*@
<div class="outerDiv">
    <div class="container cf">
        <!-- 学生简历 start -->
        <div class="part3">
            <div class="part3-header">
                <p>您可能感兴趣的学生简历</p>
            </div>
            <ul style="width: 1032px; margin: 0 auto">
                @if (Model != null && Model.Count > 0)
                {
                    foreach (var item in Model)
                    {
                        <li class="part3-list">
                            @{
                                var imgIcon = string.IsNullOrWhiteSpace(item.Head_icon)
                                    ? $"{AppSetting.Rss_Image}/content/static/images/avatar/avatar-s-1.jpg?t=208"
                                    : $"{AppSetting.Rss_Image}/{item.Head_icon}";
                                int customer_age = DateTime.Now.Year - item.Birthday.Year;
                                var sex = item.Sex == 1 ? "男" : "女";
                            }
                            <a href="/resume/invitation/@item.Customer_id" target="_blank">
                                <div class="item-header">
                                    <img src="@imgIcon" alt="@item.Real_name">
                                    <div class="item-content">
                                        <p class="photoName">@item.Real_name</p>
                                        <p>@sex/@customer_age/@item.Intentional_city_name</p>
                                    </div>
                                </div>
                                <div class="item-footer">
                                    <p>@item.Education/@item.Major/@item.University</p>
                                </div>
                            </a>
                        </li>
                    }
                }
            </ul>
        </div>
        <!-- 学生简历 end -->
        <!-- HR说 start -->
        <!-- HR说 end -->
    </div>
</div>
@*<div class="container cf" style="width: 1000px; margin: 0 auto">
    <!-- 企业进校宣讲/推广活动 start -->
    <div class="part4">
        <div class="part4-header">
            <p>企业进校宣讲/推广活动</p>
        </div>
        <div class="part4-list">
            <div class="list-item1">
                <div class="item-dateR">2015年09月16日</div>
                <a href="/extension/0" target="_blank">
                    <div class="item-content">
                        <img src="@AppSetting.Rss_Image/content/admin/Scripts/Ueditor/net/upload/2015-12-14/d6b30507-0f10-4176-afd2-4a4bc028f90c.jpg" alt="企业宣讲会/推广活动">
                        <p>
                            北京拓优&amp;新起点2016西北大学联合宣讲会
                        </p>
                    </div>
                </a>
            </div>
            <div class="list-item2">
                <div class="item-dateL">2015年09月14日</div>
                <a href="/extension/0" target="_blank">
                    <div class="item-content">
                        <img src="@AppSetting.Rss_Image/content/admin/Scripts/Ueditor/net/upload/2015-12-14/1f55a4f7-39fd-4731-8a68-99cf8bf2c9ca.jpg" alt="企业宣讲会/推广活动">
                        <p>
                            拓优顾问、新起点2016武汉大学联合宣讲会
                        </p>
                    </div>
                </a>
            </div>
            <div class="list-item3">
                <div class="item-dateR">2015年09月12日</div>
                <a href="/extension/0" target="_blank">
                    <div class="item-content">
                        <img src="@AppSetting.Rss_Image/content/admin/Scripts/Ueditor/net/upload/2015-12-14/81f48d39-7bd1-44f7-8852-cf2ea9e77772.jpg" alt="企业宣讲会/推广活动">
                        <p>
                            拓优顾问2016山东大学校园宣讲会纪实
                        </p>
                    </div>
                </a>
            </div>
            <div class="list-item4">
                <div class="item-dateL">2015年09月11日</div>
                <a href="/extension/0" target="_blank">
                    <div class="item-content">
                        <img src="@AppSetting.Rss_Image/content/admin/Scripts/Ueditor/net/upload/2015-12-14/bf7c06be-bdab-41f8-bbb2-529cafe9b7e3.jpg" alt="企业宣讲会/推广活动">
                        <p>
                            拓优青岛分公司2016青岛科技大学校园宣讲会
                        </p>
                    </div>
                </a>
            </div>
        </div>
        <div id="front-line"></div>
    </div>
    <!-- 企业进校宣讲/推广活动 end -->
</div>*@
@*<div class="outerDiv" style="background-color:#f5f5f5">
    <div class="container cf" style="width:1000px;margin:0 auto;background-color:#f5f5f5">
        <!-- 企业照片墙 start -->
        <div class="part6">
            <div class="part6-header">
                <p>合作伙伴</p>
            </div>
            <div class="part6-container">
                <ul>
                    <li class="part6-list logo1"></li>
                    <li class="part6-list logo2"></li>
                    <li class="part6-list logo3"></li>
                    <li class="part6-list logo4"></li>
                    <li class="part6-list logo5"></li>
                    <li class="part6-list logo6"></li>
                    <li class="part6-list logo7"></li>
                    <li class="part6-list logo8"></li>
                    <li class="part6-list logo9"></li>
                    <li class="part6-list logo10"></li>
                    <li class="part6-list logo11"></li>
                    <li class="part6-list logo12"></li>
                    <li class="part6-list logo13"></li>
                    <li class="part6-list logo14"></li>
                    <li class="part6-list logo15"></li>
                    <li class="part6-list logo16"></li>
                    <li class="part6-list logo17"></li>
                    <li class="part6-list logo18"></li>
                </ul>
            </div>
        </div>
        <!-- 企业照片墙 end -->
        <!-- 免费开通企业招聘服务 start -->
        <!-- 免费开通企业招聘服务 end -->
    </div>
</div>*@
<script src="/content/static/enterprise/js/lib/cycleBanner.js"></script>
<script src="/content/static/enterprise/js/lib/homepage_search.js"></script>
<script src="/content/static/lib/js/enterprise/js/jquery.slimscroll.min.js"></script>
<script src="/content/static/enterprise/js/lib/majorPicker.js"></script>
<script>
    $(function () {
        // 宣讲会浮标
        var onlineVideo = function () {
            this.defaults = {
                nodeId: ".onlineVideo",
                pageWidth: 1000,
                distanceToPage: 41,
                nodeWidth: 74,
                isLeanRight: false
            };
            this.init();
        };
        onlineVideo.prototype = {
            constructor: onlineVideo,
            init: function (options) {
                var that = this,
                    defaults = that.defaults;
                that.defaults = $.extend('', defaults, options);
                var r = that.getDistanceToRight(that.defaults);
                $(this.defaults.nodeId).css('right', r);
                $(window).resize(function () {
                    r = that.getDistanceToRight(that.defaults);
                    $(that.defaults.nodeId).css('right', r);
                });
            },
            getDistanceToRight: function (opt) {
                var $ele = $(opt.nodeId);
                var $win = $(window);
                // 节点到屏幕右边的距离 = (屏幕宽度 - 页面宽度 + 1 "此处 1px 用于消除偏移" ) / 2 - 节点宽度 - 节点左边到页面右边的宽度 (20px), 如果到右边距离屏幕边界不小于 10px
                var right = parseInt(($win.width() - opt.pageWidth + 1) / 2 - opt.nodeWidth - opt.distanceToPage, 10);
                if (/MSIE 6/i.test(navigator.userAgent)) {
                    right = parseInt(($win.width() - opt.pageWidth + 1) / 2 - opt.nodeWidth - opt.distanceToPage - 10, 10);
                }
                if (right < 10) {
                    right = 10;
                }
                if (opt.isLeanRight === true) {
                    right = 0;
                }
                return right;
            }
        };
        new onlineVideo();
        //首页banner
        $('#logo-banner').cycleBanner();
        //首页查询三组件高校级别||所在地区||专业类别
        $(document).on('click', '.level', function () {
            $(this).schoolLevel({
                inputHidden: 'input[name="schoolLevel"]'
            });
        }).on('click', '.area', function () {
            $(this).schoolArea({
                inputHidden: 'input[name="schoolArea"]'
            });
        }).on('click', '.divide', function () {
            $(this).majorPicker({
                inputHidden: 'input[name="majorClass"]'
            });
        });

        $('.btn-search').on('click', function () {
            searchSchoolInfo();
        })
        $('.part7-btn').on('click', function () {
            window.location.href = '/Account/Register';
        })
        $('.keep-login').click(function () {
            if ($(this).hasClass('active')) {
                $(this).removeClass('active');
                $('input[name="RememberMe"]').val('false');
            } else {
                $(this).addClass('active');
                $('input[name="RememberMe"]').val('true');
            }
        })
        //var suleft = $('input[name="AccountName"]').offset().left;
        //$('.pass-user').css('left', suleft);
        $('button[type="button"]').click(function (e) {
            $('.pass-user').hide();
            $.ajax({
                type: "POST",
                url: '/Account/AjaxLogin',
                data: {
                    __RequestVerificationToken: $('input[name=__RequestVerificationToken]').val(), //防跨域请求验证参数
                    AccountName: $('input[name="AccountName"]').val(),
                    Password: $('input[name="Password"]').val(),
                    RememberMe: $('input[name="RememberMe"]').val()
                },
                success: function (r) {
                    if (r.code == 0) {
                        location.href = 'home/Index';
                    } else if (r.redirecturl != null) {
                        location.href = r.redirecturl;
                    } else {
                        $('.pass-user').show();
                    }
                }
            });
        })
        $(document).on('keydown', '[name="Password"]', function (event) {
            if (event.keyCode === 13) {
                $('button[type="button"]').trigger("click");
            }
        })
    })

    function searchSchoolInfo() {
        var majorCode, schoolLevels, schoolAreas;
        majorCode = $('input[name = "majorClass"]').val();
        schoolLevels = $('input[name = "schoolLevel"]').val();
        schoolAreas = $('input[name = "schoolArea"]').val();

        if (majorCode == "" && ((schoolLevels != "" && schoolLevels != "0") || (schoolAreas != "" && schoolAreas != "0"))) {
            alert("请选择专业");
            return;
        }

        if (majorCode == "" && (schoolLevels == "" || schoolLevels == "0") && (schoolAreas == "" || schoolAreas == "0")) {
            window.open('/home/colleges-info', '_blank');
        } else if ((schoolLevels == "" || schoolLevels == "0") && (schoolAreas == "" || schoolAreas == "0")) {
            window.location.href = '/home/colleges-info?majorCode=' + majorCode;
        } else if (schoolLevels == "" || schoolLevels == "0") {
            window.location.href = '/home/colleges-info?majorCode=' + majorCode + '&' + 'schoolAreas=' + schoolAreas;
        } else if (schoolAreas == "" || schoolAreas == "0") {
            window.location.href = '/home/colleges-info?majorCode=' + majorCode + '&' + 'schoolLevels=' + schoolLevels;
        } else {
            window.location.href = '/home/colleges-info?majorCode=' + majorCode + '&' + 'schoolLevels=' + schoolLevels + '&' + 'schoolAreas=' + schoolAreas;
        }
    }
    $(function () {

        $('.nav-list').on('click', '.add-job', function (e) {
            $.ajax({
                type: 'get',
                async: false,
                url: '/Position/CheckIsPublishPositionOverLimit',
                success: function (data) {
                    if (data.isOverLimit) {
                        var cs = '<p>亲，你的帐号目前最多可发布职位数量为' + data.maxPosCount + '个，不可再发布职位了。</p>\
                                <p>如果您需要发布更多的职位，请联系我们申请提升职位数量上限。</p>\
                                <p>联系电话：021-58360268-572</p>';
                        var layer = new Layer({
                            content: cs,
                            title: '提示'
                        });
                        layer.show();
                        e.preventDefault();
                    }
                }
            });
        })
            .on('click', '.fire-btn', function (e) {

                $.ajax({
                    type: 'get',
                    async: false,
                    url: '/Position/CheckIsPublishPositionOverLimit',
                    success: function (data) {
                        if (data.isOverLimit) {
                            var cs = '<p>亲，你的帐号目前最多可发布职位数量为' + data.maxPosCount + '个，不可再发布职位了。</p>\
                                <p>如果您需要发布更多的职位，请联系我们申请提升职位数量上限。</p>\
                                <p>联系电话：021-58360268-572</p>';
                            var layer = new Layer({
                                content: cs,
                                title: '提示'
                            });
                            layer.show();
                            e.preventDefault();
                        }
                    }
                });
            })
    });
    $(function () {
        var qrcodeUrl = 'http://m.zheyibu.com/Company/H5Index/1423694'
        var testIE = navigator.userAgent;
        if (!-[1, ]) {
            $('.qr-code').qrcode({
                render: "table",
                width: 150,
                height: 150,
                text: qrcodeUrl
            });
        } else {
            $('.qr-code').qrcode({
                render: "canvas",
                width: 150,
                height: 150,
                text: qrcodeUrl
            });
        }

        $('#qr-code').show();
    })
    // 判断 ie 6,7,8
    if (!-[1, ]) {
        $("#qr-code").add("#qr-trigger").hide();
    }

    $("#qr-trigger").on("click", function () {
        $("#qr-code").is(":visible") ? $("#qr-code").fadeOut(500) : $("#qr-code").fadeIn(500);
    });

    var cs = '<div class="changephone-pop">\
                        <div class="ui-form-item">\
                            <span class="item-label"><em>*</em>修改电话号码:</span>\
                            <input type="text" value="021" class="ui-text ui-text-s" id="areaCode" placeholder="区号">\
                            <input type="text" value="88888888" class="ui-text ui-text-m" id="telPhone" placeholder="电话号码">\
                            <input type="text" value="" class="ui-text ui-text-s" id="ext" placeholder="分机(选填)">\
                        </div>\
                      </div>';

    $('#UpdatePhone').click(function () {
        var layer = new Layer({
            content: cs,
            button: [{
                id: 'ok',
                value: '修改'
            }],
            ok: function () {
                if ($('#areaCode').val() == '') {
                    alert('区号不能为空！');
                    return false;
                } else if (!$('#areaCode').val().match(/^\d{3,4}$/)) {
                    alert('请输入正确的区号');
                    return false;
                }
                if ($('#telPhone').val() == '') {
                    alert('电话号码不能为空！');
                    return false;
                } else if (!$('#telPhone').val().match(/^\d{7,8}$/)) {
                    alert('请输入正确的号码');
                    return false;
                }
                var data = {};
                data.ContactAreaCode = $('#areaCode').val();
                data.ContactTelephone = $('#telPhone').val();
                data.ContactExt = $('#ext').val();
                data.__RequestVerificationToken = $('input[name=__RequestVerificationToken]').val();
                $.ajax({
                    type: 'post',
                    datatype: 'json',
                    url: '/Profile/SaveCompanyContact',
                    data: data,
                    success: function (data) {
                        if (data.code == 0) {
                            layer.remove();
                            var tips = new Layer({
                                content: '<div class="txtBox"><i class="tips-icon icon-success"></i><p>修改成功</p></div>',
                                button: [{
                                    id: 'ok',
                                    value: '确定'
                                }],
                                ok: function () {
                                    this.remove();
                                }
                            });
                            tips.show();
                        } else {
                            alert(data.msg);
                        }
                    }
                })
            }
        });
        layer.show();
        $('.ui-layer-header').css({
            'background': '#85b0dc'
        });

    })
</script>
