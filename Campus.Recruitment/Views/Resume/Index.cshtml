@using Campus.Recruitment.Models
@model Campus.Recruitment.Entities.Entity.Customers.CustomerAll
@{
    Layout = "~/Views/Shared/_LayoutLogin.cshtml";
    ViewBag.Title = "在线简历";
}

<script src="@AppSetting.Rss_Image/content/static/zheyibu/components/jQuery/jquery.min.js"></script>
<script src="@AppSetting.Rss_Image/content/static/zheyibu/static/js/global.js"></script>
<script src="@AppSetting.Rss_Image/content/static/zheyibu/components/mCustomScrollbar/jquery.mCustomScrollbar.concat.min.js"></script>
<link rel="stylesheet" href="@AppSetting.Rss_Image/content/static/zheyibu/components/mCustomScrollbar/jquery.mCustomScrollbar.css">
<link rel="stylesheet" href="@AppSetting.Rss_Image/content/static/zheyibu/static/css/global.css">
<link href="@AppSetting.Rss_Image/content/static/css/zyb/zyb-new20150121.css" rel="stylesheet" type="text/css">
<script src="@AppSetting.Rss_Image/content/static/zheyibu/static/js/coding.js"></script>
<link href="@AppSetting.Rss_Image/content/static/css/zyb/zyb-user.css" rel="stylesheet" type="text/css">
<link href="@AppSetting.Rss_Image/content/static/css/zyb/zyb-resume-new.css" rel="stylesheet" type="text/css">
<link href="@AppSetting.Rss_Image/content/static/css/zyb/resumeform/zyb-resume-form.css" rel="stylesheet" type="text/css">
<link href="@AppSetting.Rss_Image/content/static/zheyibu/static/css/dialog.css" rel="stylesheet" type="text/css">
<link href="@AppSetting.Rss_Image/content/static/zheyibu/static/css/layer.css" rel="stylesheet" type="text/css">
<link href="@AppSetting.Rss_Image/content/static/zheyibu/static/css/DatePicker.new.css" rel="stylesheet">
<link href="@AppSetting.Rss_Image/content/static/zheyibu/static/css/selectui.css" rel="stylesheet">
<link href="@AppSetting.Rss_Image/content/static/css/corp/dialog.css" rel="stylesheet">
<link href="@AppSetting.Rss_Image/content/static/student/css/landpage/userCenter.css" rel="stylesheet">
<script src="@AppSetting.Rss_Image/content/static/js/sea-modules/seajs/seajs/2.1.1/sea.js" type="text/javascript"></script>
<script type="text/javascript">
    seajs.config({
        alias: {
            $: 'jquery/jquery/1.7.2/jquery',
            placeholder: 'jquery/placeholder/1.0.0/placeholder',
            dialog: 'arale/dialog/1.2.3/dialog',
            calendar: 'arale/calendar/1.0.0/calendar',
            validator: 'arale/validator/0.9.7/validator',
            jqueryform: 'jquery/form/3.49.0/form'
        }
    });
</script>
<link charset="utf-8" rel="stylesheet" href="@AppSetting.Rss_Image/content/static/js/sea-modules/module/topucdialog/1.1.5/topucdialog.css">
<link charset="utf-8" rel="stylesheet" href="@AppSetting.Rss_Image/content/static/js/sea-modules/jquery/autocomplete/1.1.0/autocomplete.css">
<div class="content">
    <div class="content-in">
        <!--左侧功能栏开始-->
        <div class="user-left">
            <div class="resume-all" style="margin-top:0px;">
                <ul class="left-resume">
                    <li class="resume-module-title">
                        我的简历
                    </li>
                    <li class="resume-module-item active ">
                        <a href="/resume/0">在线简历</a>
                    </li>
                </ul>
                <ul class="left-resume">
                    <li class="resume-module-title">
                        我的求职
                    </li>
                    <li class="resume-module-item  apply">
                        <a href="/position/apply">申请的职位</a>
                        <i class="num"></i>
                    </li>
                    @*<li class="resume-module-item  push">
                            <a href="/position/recommend">推荐的职位</a>
                            <i class="num"></i>
                        </li>*@
                    <li class="resume-module-item  hrinvite">
                        <a href="/position/hr-invintes">HR邀请</a>
                        <i class="num"></i>
                    </li>
                    <li class="resume-module-item ">
                        <a href="/position/collection-post">收藏的职位</a>
                        <i class="num"></i>
                    </li>
                </ul>
            </div>
        </div>
        <script>
            $(function () {
                var a = $("#homepage-header .user-info").attr("data-applycount"),
                    f = $("#homepage-header .user-info").attr("data-pushcount"),
                    d = $("#homepage-header .user-info").attr("data-hrinvitecount"),
                    b = $("#homepage-header .user-info").attr("data-followcount"),
                    c = $("#homepage-header .user-info").attr("data-unreadqacount"),
                    e = $("#homepage-header .user-info").attr("data-unreadhrmessagecount");
                if (a != 0) {
                    $(".apply").find(".num").text(a);
                    $(".applyReply").text(a)
                } else {
                    $(".applyReply").text(a)
                }
                if (f != 0) {
                    $(".push").find(".num").text(f);
                    $(".pushPos").text(f)
                } else {
                    $(".pushPos").text(f)
                }
                if (d != 0) {
                    $(".hrinvite").find(".num").text(d);
                    $(".hrInvite").text(d)
                } else {
                    $(".hrInvite").text(d)
                }
                if (b != 0) {
                    $(".follow").find(".num").text(b);
                    $(".comFollow").text(b)
                } else {
                    $(".comFollow").text(b)
                }
                if (c != 0) {
                    $(".unreadqa").find(".num").text(c)
                }
                if (e != 0) {
                    $(".unreadhrmsg").find(".num").text(e)
                }
            });
        </script>
        <!--左侧功能栏结束-->
        <div class="right-resume">
            <div class="resume-display clearfix">
                <div id="base-anchor"></div>
                <div id="m-links">
                    <div class="links-left">
                        <label>当前求职状态：</label>
                        <input type="radio" name="JobStatus" checked="" value="1">
                        <label>求职中</label>
                        <input type="radio" name="JobStatus" value="2">
                        <label>已找到工作</label>
                    </div>
                    <ul>
                        <li><a href="/resume/preview?id=@Model.customerBase.Customer_id" target="_blank">预览简历</a></li>
                    </ul>
                </div>
                <div class="main">
                    <div id="edit-resume">
                        <div class="resume-section" id="section-base">
                            <div class="section-mask">
                                <div class="resume-section-wrap">
                                    <i class="section-ico section-ico-base"></i>
                                    <h2><span>基本信息</span></h2>
                                    <div class="container clearfix">
                                        @Html.Partial("_Detail",Model.customerBase)
                                    </div>
                                    <div class="resume-add">
                                        <div class="add-btn add-more-btn J_EditBase hover-tran" itemtype="base" style="display: inline-block;">编辑</div>
                                    </div>
                                </div>
                            </div>
                            <div id="education-anchor" class="resume-anchor"></div>
                        </div>
                        <div class="resume-section" id="section-education">
                            <div class="section-mask">
                                <div class="resume-section-wrap">
                                    <i class="section-ico section-ico-education"></i>
                                    <h2><span>教育经历</span></h2>
                                    <div class="container clearfix">
                                        @Html.Partial("_Education",Model.customerEducationList)
                                    </div>
                                    <div class="resume-add ">
                                        <div class="add-btn add-more-btn J_ActionBtn hover-tran" rel="add" itemtype="education" style="display: inline-block;">新增一条</div>
                                        <p class="add-p firstP">提示：丰富而完整的教育经历更有利于HR对你的了解，增加求职成功率！</p>
                                        <p class="add-p">若你有多份教育经历，建议添加完整</p>
                                    </div>
                                </div>
                            </div>
                            <div id="position-anchor" class="resume-anchor"></div>
                        </div>
                        <div class="resume-section" id="section-position">
                            <div class="section-mask">
                                <div class="resume-section-wrap">
                                    <i class="section-ico section-ico-position"></i>
                                    <h2><span>校内职务</span></h2>
                                    <div class="container clearfix">
                                        @Html.Partial("_IntramuralJob",Model.customerIntramuralJobList)
                                    </div>
                                    <div class="resume-add ">
                                        <div class="add-btn add-more-btn J_ActionBtn hover-tran" rel="add" itemtype="position">新增一条</div>
                                    </div>
                                </div>
                            </div>
                            <div id="scholarship-anchor" class="resume-anchor"></div>
                        </div>
                        <div class="resume-section" id="section-scholarship">
                            <div class="section-mask">
                                <div class="resume-section-wrap">
                                    <i class="section-ico section-ico-scholarship"></i>
                                    <h2><span>校内奖励</span></h2>
                                    <div class="container clearfix">
                                        @Html.Partial("_IntramuralReward",Model.customerIntramuralRewardList)
                                    </div>
                                    <div class="resume-add ">
                                        <div class="add-btn add-more-btn J_ActionBtn hover-tran" rel="add" itemtype="scholarship" style="display: inline-block;">新增一条</div>
                                    </div>
                                </div>
                            </div>
                            <div id="experience-anchor" class="resume-anchor"></div>
                        </div>
                        <div class="resume-section" id="section-experience">
                            <div class="section-mask">
                                <div class="resume-section-wrap">
                                    <i class="section-ico section-ico-experience"></i>
                                    <h2><span>实习/工作经历</span></h2>
                                    <div class="container clearfix">
                                        @Html.Partial("_Experience",Model.customerExperienceList)
                                    </div>
                                    <div class="resume-add ">
                                        <div class="add-btn add-more-btn J_ActionBtn hover-tran" rel="add" itemtype="experience" style="display: inline-block;">新增一条</div>
                                    </div>
                                </div>
                            </div>
                            <div id="project-anchor" class="resume-anchor"></div>
                        </div>
                        <div class="resume-section" id="section-project">
                            <div class="section-mask">
                                <div class="resume-section-wrap">
                                    <i class="section-ico section-ico-project"></i>
                                    <h2>
                                        <span>项目经历</span>
                                    </h2>
                                    <div class="container clearfix">
                                        @Html.Partial("_Project",Model.customerProjectList)
                                    </div>
                                    <div class="resume-add ">
                                        <div class="add-btn add-more-btn J_ActionBtn hover-tran" rel="add" itemtype="project">新增一条</div>
                                    </div>
                                </div>
                            </div>
                            <div id="language-anchor" class="resume-anchor"></div>
                        </div>
                        <div class="resume-section" id="section-language">
                            <div class="section-mask">
                                <div class="resume-section-wrap">
                                    <i class="section-ico section-ico-language"></i>
                                    <h2><span>语言能力</span></h2>
                                    <div class="container clearfix">
                                        @Html.Partial("_Language", Model.customerLanguageList)
                                    </div>
                                    <div class="resume-add">
                                        <div class="add-btn add-more-btn J_ActionBtn hover-tran" rel="add" itemtype="language">新增一条</div>
                                    </div>
                                </div>
                            </div>
                            <div id="it-anchor" class="resume-anchor"></div>
                        </div>
                        <div class="resume-section" id="section-it">
                            <div class="section-mask">
                                <div class="resume-section-wrap">
                                    <i class="section-ico section-ico-it"></i>
                                    <h2><span>IT技能</span></h2>
                                    <div class="container clearfix">
                                        @Html.Partial("_ITSkill", Model.customerItSkillList)
                                    </div>
                                    <div class="resume-add">
                                        <div class="add-btn add-more-btn J_ActionBtn hover-tran" rel="add" itemtype="it">新增一条</div>
                                    </div>
                                </div>
                            </div>
                            <div id="cert-anchor" class="resume-anchor"></div>
                        </div>
                        <div class="resume-section" id="section-cert">
                            <div class="section-mask">
                                <div class="resume-section-wrap">
                                    <i class="section-ico section-ico-cert"></i>
                                    <h2><span>获得证书</span></h2>
                                    <div class="container clearfix">
                                        @Html.Partial("_Certificate",Model.customerCertificateList)
                                    </div>
                                    <div class="resume-add">
                                        <div class="add-btn add-more-btn J_ActionBtn hover-tran" rel="add" itemtype="cert">新增一条</div>
                                    </div>
                                </div>
                            </div>
                            <div id="recommend-anchor" class="resume-anchor"></div>
                        </div>
                        <div class="resume-section" id="section-speciality">
                            <div class="section-mask">
                                <div class="resume-section-wrap">
                                    <i class="section-ico section-ico-speciality"></i>
                                    <h2><span>个人特长</span></h2>
                                    <div class="container clearfix">
                                        <div id="info-speciality" class="info-holder">
                                            <!--无数据end-->
                                            <div class="info-item">
                                                <div class="info-col">
                                                    <div>@Model.customerBase.Specialty_desc</div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="resume-add">
                                        <div class="add-btn add-more-btn J_ActionBtn J_EditSpeciality hover-tran" rel="edit" itemtype="speciality">编辑</div>
                                    </div>
                                </div>
                            </div>
                            <div id="eval-anchor" class="resume-anchor"></div>
                        </div>
                        <div class="resume-section" id="section-eval">
                            <div class="section-mask">
                                <div class="resume-section-wrap">
                                    <i class="section-ico section-ico-base"></i>
                                    <h2><span>自我评价</span></h2>
                                    <div class="container clearfix">
                                        <div id="info-eval" class="info-holder">
                                            <!--无数据end-->
                                            <div class="info-item">
                                                <div class="info-col">
                                                    <div class="self-description">@Model.customerBase.Eval_desc</div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="resume-add">
                                        <div class="add-btn add-more-btn J_ActionBtn J_EditEval hover-tran" rel="edit" itemtype="eval">编辑</div>
                                    </div>
                                </div>
                            </div>
                            <div id="anchor-last" class="resume-anchor"></div>
                        </div>
                        <div id="resumeMask"></div>
                    </div>
                </div>
            </div>
        </div>

    </div>
</div>
<!--新弹出层-->
<div class="o-layer1">
    <div class="o-box">
        <i class="pointer">×</i>
        <h1>头像上传提示</h1>
        <div class="o-bg-img1"></div>
        <p class="s-word1">简历完善的不错哦，但也不要忘记了<span class="upload-pic">上传头像...</span></p>
        <p class="s-word2">有头像，更容易获得企业关注，增加HR对你的印象呢！</p>
        <p class="clearfix mt20">
            <a class="o-button1">立即上传</a>
            <a class="o-button2 ml20">稍后上传</a>
        </p>
    </div>
</div>
<div class="o-layer2">
    <div class="o-box">
        <i class="pointer">×</i>
        <h1>小步提醒</h1>
        <div class="o-bg-img2"></div>
        <p class="s-word1">只差一步，即可获取精准职位推荐</p>
        <p class="s-word2">简历和职位理想是小步为你推荐职位的重要依据，明确的职业理想将大大提升职位推荐的准确度。</p>
        <p class="clearfix mt20">
            <a href="/resume/myobjective/" class="o-button1">填写职业理想</a>
        </p>
    </div>
</div>
<div class="o-layer3">
    <div class="o-box">
        <i class="pointer">×</i>
        <h1>小步提醒</h1>
        <p class="s-word1">你的简历有以下几个模块未填写。完善度越高，求职成功率越高！</p>
        <p class="s-word11">点击下方链接快速填写：</p>
        <p class="s-word2"></p>
        <p class="clearfix mt20">
            <a class="o-button1" style="float: left;margin-left: 264px; padding:3px 22px;">暂不填写</a>
        </p>
    </div>
</div>
<div class="o-layer">
    <div class="layer-inner">
        <div id="photowh">
            <div class="m-close"></div>
            <div class="m-uploadPic">上传头像</div>
        </div>
    </div>
</div>

<script>
    var RootUrl = '/';
</script>
<script src="@AppSetting.Rss_Image/content/static/js/corp/dialog.js"></script>
<script src="@AppSetting.Rss_Image/content/static/enterprise/lib/components/form/uploader/webuploader.js" type="text/javascript"></script>
<script type="text/javascript">
    //求职状态
    if ('@Model.customerBase.Is_work' == 'true' || '@Model.customerBase.Is_work' == 'True') {
        $("[name=JobStatus]").eq(1).attr("checked", "checked");
    } else {
        $("[name=JobStatus]").eq(0).attr("checked", "checked");
    }
    var hasName = '孙振宇';
    seajs.config({
        alias: {
            validator: 'arale/validator/0.9.7/validator',
            widget: 'arale/widget/1.1.1/widget',
            jqueryAutocomplete: 'jquery/autocomplete/1.1.0/autocomplete',
            topucdialog: 'module/topucdialog/1.1.5/topucdialog',
            jqueryform: 'jquery/form/3.49.0/form',
            selectui: 'module/selectui/selectui', //新版
            layerpick: 'module/layer/plugin/pick/1.0.3/layer-pick'
        }
    });
    seajs.use('zyb/resume/1.0.3/resume');
    seajs.use(['module/layer/1.0.3/layer', '$'], function (layer, $) {
        $(function () {
            //$uploadSelfPhoto = $('#uploadAvatar img').attr('src').split('avatar').length;
            ////读cookie判断是否有头像
            //if (global.getCookie('uploadSelfPhoto')) {
            //    //有cookie
            //} else {
            //    //没有头像
            //    if ($uploadSelfPhoto != 1) {
            //        $('.o-layer').show();
            //        setCookieNamePic('uploadSelfPhoto', 'self_photo');
            //    }
            //}

            function setCookieNamePic(name, value) {
                var Days = 7;
                var exp = new Date();
                exp.setTime(exp.getTime() + Days * 24 * 60 * 60 * 1000);
                document.cookie = name + "=" + value + ";expires=" + exp.toGMTString();
            }
            //头像区相关闭关和上传操作
            $('.m-close').click(function () {
                $('.o-layer').hide();
            });
            $('.m-uploadPic').click(function () {
                $('.o-layer').hide();
                $('#uploadAvatar').trigger('click');
            });
            //申请职位区域滚动效果
            $(window).scroll(function () {
                if ($(document).scrollTop() > 110) {
                    $('.apply-div').css({
                        position: "fixed",
                        top: 0,
                        left: 0,
                        zIndex: 2
                    });
                } else {
                    $('.apply-div').removeAttr("style");
                }
                if ($(document).scrollTop() > 60) {
                    $('.right-quick-nav').css({
                        position: "fixed",
                        top: 30
                    })
                } else {
                    $('.right-quick-nav').removeAttr("style");
                }
            });

            $('.sideCatalog-sidebar-start').hover(function () {
                $(this).parent().addClass('show');
            })

            $('.sideCatalog-sidebar-end').click(function () {
                $(this).parent().removeClass('show');
            })

        });
        $(document).on('click', 'li .m_validate', function () {
            var applyPop = new Layer();
            var phone_num = $(this).attr("data-value");
            var data = '<div class="ui-layer-header" data-role="header" move="ok" style="cursor: move;">\
                            <div class="ui-layer-title" data-role="title" style="padding:20px;">\
                            <h3>手机号码验证</h3>\
                            </div><button class="ui-layer-close" data-role="close">×</button>\
                            </div>\
                            <div class="pop" style="padding:40px 0;">\
                                <div class="option ml40" style="margin-bottom:15px;"><label>手机号码：' + phone_num + '</label><input type="hidden" name="mobile" disabled="" value="' + $(this).attr("data-value") + '"></div>\
                                <div class="option ml40" style="margin-bottom:5px;"><label>&emsp;验证码：</label><input maxlength="9" class="w100" type="text" name="code"><a href="javascript:void(0);" class="getcode" data-value="' + phone_num + '">获取验证码</a></div>\
                                <div style="margin-left:120px;color:#ccc;" class="sendsuccess dN">验证码已发送，请查收短信</div>\
                                <div style="margin-left:120px;color:#ec605f;" class="errorcode dN">验证码不正确</div>\
                                <div class="bind-account">\
                                <a href="javascript:void(0)" class="validate mt20">验证</a>\
                                </div>\
                            </div>';
            applyPop.setContent(data).show();
            $('#hide-head').css('display', 'none');
            $('.ui-layer-content').css('padding', '0');
            bindClick();
            $('.pop .validate').on('click', function () {
                var code = $('input[name="code"]').val();
                if (code.trim().length == 0) {
                    $('.pop .sendsuccess').addClass('dN');
                    $('.pop .errorcode').removeClass('dN').html('请填写验证码');
                } else {
                    $('.pop .sendsuccess').addClass('dN');
                    var mobile = $('input[name="mobile"]').val();
                    var code = $('input[name="code"]').val();
                    $.ajax({
                        type: "post",
                        url: '/account/ValidateMobileNoCode?mobile=' + mobile + '&code=' + code,
                        success: function (data) {
                            if (data.code == 0) {
                                applyPop.remove();
                                validateSuccess();
                            } else if (data.code == 1) {
                                $('.pop .errorcode').addClass('dN');
                                $('.pop .errorcode').removeClass('dN').html('验证码不正确');
                            }
                        },
                        error: function (XMLHttpRequest, textStatus, errorThrown) { }
                    });

                }
            });
        });

        function bindClick() {
            $('a.getcode').on('click', function () {
                var _this = $(this);
                var mobile = _this.attr('data-value');
                $.ajax({
                    type: "post",
                    url: '/account/SendMobileNoVerificationCode?mobile=' + mobile,
                    success: function (data) {
                        _this.unbind();
                        _this.addClass('disabled');
                        $('.pop .sendsuccess').removeClass('dN');
                        $('.pop .errorcode').addClass('dN');
                        var time = 60;
                        _this.html(time + 's后重试');
                        var codeTime = setInterval(function () {
                            time--;
                            _this.html(time + 's后重试');
                            if (time < 1) {
                                clearInterval(codeTime);
                                _this.removeClass('disabled').html('获取验证码');
                                bindClick();
                            }
                        }, 1000);
                    },
                    error: function (XMLHttpRequest, textStatus, errorThrown) {

                    }
                });
            });
        }

        function validateSuccess() {
            var applyPop = new Layer();
            var data = '<div class="ui-layer-header" data-role="header" move="ok" style="cursor: move;">\
                            <div class="ui-layer-title" data-role="title" style="padding:20px;">\
                            <h3>验证提示</h3>\
                            </div><button class="ui-layer-close" data-role="close">×</button>\
                            </div>\
                            <div class="pop" style="padding:40px 0;">\
                                <div class="bind-account">\
                                <p>手机号码验证成功！</p>\
                                <a href="javascript:void(0)" onclick="window.location.href=window.location.pathname;" class="mt40">确定</a>\
                                </div>\
                            </div>';
            applyPop.setContent(data).show();
            $('#hide-head').css('display', 'none');
            $('.ui-layer-content').css('padding', '0');
        }
        $('#m-links li').click(function () {
            $(this).parent().find('.active').removeClass('active');
            $(this).children().first().addClass('active');
        });
        $('#m-transform').click(function () {
            $('#edit-resume').hide();
            $('#transform-email').show();
            $('.content .base-width').hide();
        });
        $('#m-editR').click(function () {
            $('#edit-resume').show();
            $('#transform-email').hide();
            $('.content .base-width').show();
        });
        //转发简历操作
        $('#e-address').blur(function () {
            var tempAdd = $(this).val(),
                reg = /^[a-zA-Z0-9._-]+[a-zA-Z0-9_-]+(\.[a-zA-Z]+)+$/,  @*/^[a-zA-Z0-9._-]+@[a-zA-Z0-9_-]+(\.[a-zA-Z]+)+$/,*@
                treg = reg.test(tempAdd),
                sibling = $(this).siblings('#m-warning');
            if (!tempAdd) {
                $(sibling).html('邮箱地址不为空');
                $(sibling).css('visibility', 'visible');
            } else {
                if (treg) {
                    $(sibling).css('visibility', 'hidden');
                } else {
                    $(sibling).html('邮箱地址格式不正确');
                    $(sibling).css('visibility', 'visible');
                }
            }
        });
        $('#e-title').blur(function () {
            var temp = $(this).val(),
                sibling = $(this).siblings('#m-warning');
            if (!temp) {
                $(sibling).css('visibility', 'visible');
            } else {
                $(sibling).css('visibility', 'hidden');
            }
        });
        $('#e-content').blur(function () {
            var temp = $(this).val(),
                sibling = $(this).siblings('#m-warning');
            if (!temp) {
                $(sibling).css('visibility', 'visible');
            } else {
                $(sibling).css('visibility', 'hidden');
            }
        });
        $('#m-tbtn').click(function () {
            var eadd = $('#e-address').val(),
                etitle = $('#e-title').val(),
                econtent = $('#e-content').val(),
                flag = true;
            if (!eadd) {
                $('.m-section:first #m-warning').css('visibility', 'visible');
                flag = false;
            } else {
                var reg = /^[a-zA-Z0-9._-]+[a-zA-Z0-9_-]+(\.[a-zA-Z]+)+$/,@*/^[a-zA-Z0-9._-]+@[a-zA-Z0-9_-]+(\.[a-zA-Z]+)+$/,*@
                    treg = reg.test(eadd);
                if (!treg) {
                    $('.m-section:first #m-warning').css('visibility', 'visible');
                    flag = false;
                }
            }

            if (!econtent) {
                $('.m-section:last').find('#m-warning').css('visibility', 'visible');
                flag = false;
            }
            if (!etitle) {
                $('.m-section:nth-child(2)').find('#m-warning').css('visibility', 'visible');
                flag = false;
            }
            var data = {
                SendTo: $('#e-address').val(),
                SendSubject: $('#e-title').val(),
                SendBody: $('#e-content').val()
            }
            if (flag) {
                $.ajax({
                    type: 'POST',
                    url: '/resume/forwordresume/',
                    data: data,
                    beforeSend: function () {
                        $('#transform-email .loading').show();
                    },
                    success: function (data) {
                        if (data.code == 1) {
                            $('#transform-email .loading').hide();
                            var recordList = data.data
                            var Html = '<div class="m-record"><ul>';
                            for (var i = 0; i <= recordList.length && recordList[i] != undefined; i++) {
                                var record = recordList[i];

                                var SendTo = record.SendTo;
                                var SendSubject = record.SendSubject;
                                var SendTime = record.SendTime;
                                Html += ' <li><p>发送邮箱：' + SendTo + '<span>' + SendTime + '</span></p><p>邮件标题：' + SendSubject + '</p></li>';
                                //dynamic insert
                            }
                            Html += ' </ul></div>'
                            $("#section-record .container  ").html(Html);
                            $('#e-address').val("");
                            alert("转发成功")
                        }
                    },
                    error: function (r) {
                        alert(r.msg);
                    }
                });
            }
        });
        $("input[name=JobStatus]").each(function () {
            var $this = $(this)
            $this.next().click(function () {
                $this.click();
            })
            $this.change(function () {
                $.ajax({
                    url: "/resume/update-work-state",
                    data: {
                        flag: $("input[name=JobStatus]:checked").val()
                    },
                    type: "post",
                    success: function (a) {
                        if (a) {
                            window.location.href = "/resume/@Model.customerBase.Customer_id";
                        } else {
                            alert("求职状态修改失败，请重试 ");
                        }

                    }
                })
            })
        })

        if (!WebUploader.Uploader.support()) {
            alert('该应用不支持您的浏览器！如果你使用的是IE浏览器，请尝试升级 flash 播放器');
            throw new Error('暂不支持该浏览器');
        }
        if (WebUploader.Uploader.support()) {
            var uploader = WebUploader.create({
                auto: true,
                pick: {
                    id: '.J_Editrecommond',
                    multiple: false
                },
                swf: 'http://www.zheyibu.com/Uploader.swf',
                server: 'http://upload.zheyibu.com/api/StuUpload/PostReferenceFile/136526',
                accept: {
                    title: 'Images',
                    extensions: 'gif,jpg,jpeg,bmp,png',
                    mimeTypes: 'image/png,image/gif,image/jpg,image/jpeg,image/bmp'
                }
            });
            uploader.on('uploadSuccess', function (file, data) {
                if (data.code == 0) {
                    $.ajax({
                        type: 'POST',
                        url: '/Resume/SaveReference/',
                        data: {
                            path: data.path
                        },
                        success: function (data) {
                            //刷新右侧指示标志
                            $('#nav-recommond').addClass('current');
                            //插入数据
                            $('.gra-recommond').find('img').attr('src', data.thumbnailUrl).end().find('span').attr('data-id', data.id).end().addClass('seelook').show();
                            $('.no-recommond').hide();
                        },
                        error: function (msg) {
                            console.log(msg);
                        }
                    })
                }
            });
        }
        if (WebUploader.Uploader.support()) {
            var uploader = WebUploader.create({
                auto: true,
                pick: {
                    id: '.J_EditRecommondd',
                    multiple: false
                },
                swf: 'http://www.zheyibu.com/Uploader.swf',
                server: 'http://upload.zheyibu.com/api/StuUpload/PostReferenceFile/136526',
                accept: {
                    title: 'Images',
                    extensions: 'gif,jpg,jpeg,bmp,png',
                    mimeTypes: 'image/png,image/gif,image/jpg,image/jpeg,image/bmp'
                }
            });
            uploader.on('uploadSuccess', function (file, data) {
                if (data.code == 0) {
                    $.ajax({
                        type: 'POST',
                        url: '/Resume/SaveReference/',
                        data: {
                            path: data.path
                        },
                        success: function (data) {
                            //插入数据
                            $('.exist-recommond').find('img').attr('src', data.thumbnailUrl).end().find('span').attr('data-id', data.id).end().addClass('seelook').show();
                            $('.hide-btn').css('visibility', 'hidden');
                        },
                        error: function (msg) {
                            console.log(msg);
                        }
                    })
                }
            });
        }
        if (WebUploader.Uploader.support()) {
            var uploader = WebUploader.create({
                auto: true,
                pick: {
                    id: '.J_EditRecommond',
                    multiple: false
                },
                swf: 'http://www.zheyibu.com/Uploader.swf',
                server: 'http://upload.zheyibu.com/api/StuUpload/PostReferenceFile/136526',
                accept: {
                    title: 'Images',
                    extensions: 'gif,jpg,jpeg,bmp,png',
                    mimeTypes: 'image/png,image/gif,image/jpg,image/jpeg,image/bmp'
                }
            });
            uploader.on('uploadSuccess', function (file, data) {
                if (data.code == 0) {
                    $.ajax({
                        type: 'POST',
                        url: '/Resume/SaveReference/',
                        data: {
                            path: data.path
                        },
                        success: function (data) {
                            //插入数据
                            $('.exist-recommond').find('img').attr('src', data.thumbnailUrl);
                        },
                        error: function (msg) {
                            console.log(msg);
                        }
                    })
                }
            });
        }
        if (WebUploader.Uploader.support()) {
            var uploader = WebUploader.create({
                auto: true,
                pick: {
                    id: '#editRecommond',
                    multiple: false
                },
                swf: 'http://www.zheyibu.com/Uploader.swf',
                server: 'http://upload.zheyibu.com/api/StuUpload/PostReferenceFile/136526',
                accept: {
                    title: 'Images',
                    extensions: 'gif,jpg,jpeg,bmp,png',
                    mimeTypes: 'image/png,image/gif,image/jpg,image/jpeg,image/bmp'
                }
            });
            uploader.on('uploadSuccess', function (file, data) {
                if (data.code == 0) {
                    $.ajax({
                        type: 'POST',
                        url: '/Resume/SaveReference/',
                        data: {
                            path: data.path
                        },
                        success: function (data) {
                            //插入数据
                            $('.gra-recommond').find('img').attr('src', data.thumbnailUrl);
                        },
                        error: function (msg) {
                            console.log(msg);
                        }
                    })
                }
            });
        }
        $('#info-recommond').on('click', '.remove-upload', function () {
            var _this = $(this);
            removeDialog = new Dialog();
            removeDialog.init({
                width: 588,
                target: '<div id="uploader" class="legend-info" style="text-align:center;font-family:microsoft yahei">\
                                <p style="text-align:center;font-family:microsoft yahei;font-size:16px;line-height:1.5;color:#666;padding-top:30px;">确认删除该就业推荐表吗？删除后将不可恢复！</p>\
                                <div style="text-align:center;margin:30px 0;"><span class="upload-remove" style="display:inline-block;text-align:center;color:#fff;line-height:48px;width:130px;border-radius:3px;margin-right:40px;background:#6BC371;font-size:18px;cursor:pointer;">确定</span><span class="upload-dispose" style="display:inline-block;text-align:center;color:#fff;line-height:48px;width:130px;border-radius:3px;margin-right:40px;background:#6BC371;font-size:18px;cursor:pointer;">取消</span></div>\
                        </div>',
                trigger: $(this),
                mask: true,
                title: '提示'
            });
            removeDialog.show();
            $('.ui-dialog-title').css({
                'width': '558px',
                'background-color': '#6BC371',
                'border': 'none'
            });
            $('.upload-remove').click(function () {
                $('#nav-recommond').removeClass('current');
                $.ajax({
                    type: 'POST',
                    url: '/Resume/DeleteReference/',
                    data: {
                        id: _this.attr('data-id')
                    },
                    success: function () {
                        //插入数据
                        removeDialog.dispose();
                        if ($('.gra-recommond').length) {
                            $('.gra-recommond').removeClass('seelook');
                            $('.no-recommond').show();
                        } else {
                            $('.hide-btn').css('visibility', 'visible');
                            $('.exist-recommond').hide();
                        }
                    },
                    error: function (msg) {
                        console.log(msg);
                    }
                })
            });
            $('.upload-dispose').click(function () {
                removeDialog.dispose();
            })
        })
        var wtxLen = $('.base-info-col').find('li');
        $.each(wtxLen, function (i, v) {
            if ($(v).text().indexOf('未填写') !== -1) {
                $(v).addClass('wtx');
            }
        })
        $('#edit-resume').on('click', 'input[name="newName"]', function () {
            var alertChongu = new Layer({
                title: '提示'
            }),
                data = '<p style="text-align:center;line-height:2;font-size:18px;">姓名不可修改</p>';
            if (hasName) {
                alertChongu.setContent(data).show();
            }

        });
    });
</script>
<script src="@AppSetting.Rss_Image/content/static/js/zyb/navigation.js" type="text/javascript"></script>

